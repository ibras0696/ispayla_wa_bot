# ТЗ (MVP WhatsApp-бот)

## Что уже реализовано
- Green API бот: меню «Профиль», «Продажа», «Покупка».
- Продажа: мастер создания объявления (поля + фото), «Мои объявления», просмотр деталей по номеру/ID.
- Покупка: каталог активных объявлений с фильтрами (цена/год/пробег/марка), поиск, пагинация, избранное, карточки с фото.
- БД Postgres: CRUD для объявлений, фото, брендов, избранного; сохранение фильтров (пока файл).
- Инфра: Docker/compose, Makefile, .env, whitelist отправителей.
- Добавлены поля объявления: марка и модель отдельно, регион, состояние (целый/после ДТП), до 3 фото; кнопки «Назад» в профиле и списке объявлений.
- Alembic-ревизия для новых колонок (model_name, region, condition).

## План доработок (MVP+)
1) **State/хранение**
   - Убрать файл `state_filters.json`, хранить фильтры/состояния в Redis.
   - Перенести состояние формы продажи в внешнее хранилище.

2) **Покупка**
   - Карточка: отправлять все фото, кнопки «В избранное/Убрать», удаление из избранного.
   - Поиск + фильтры в одном потоке (без ручного сброса).
   - Полировка пагинации (кнопки/тексты).

3) **Продажа**
   - Модерация объявлений (статусы, публикация после approve).
   - Валидации, лимиты фото, UX сообщений.

4) **Монетизация/платежи**
   - Баланс, ЮKassa, продление публикаций.

5) **Инфра/качество**
   - Alembic миграции.
   - Тесты: хендлеры покупки/продажи, фильтры, избранное.
   - Объектное хранилище (S3) для фото.
   - Логи/метрики, админ-команды.

## Быстрые next steps
- Перенести фильтры/состояния в Redis.
- Доработать карточки покупки (кнопки избранного, все фото).
- Написать базовые тесты на фильтры/избранное/пагинацию.
